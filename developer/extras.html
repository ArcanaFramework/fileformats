<!doctype html>
<html class="no-js" lang="English" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Extensions" href="extensions.html" />
        <link rel="prefetch" href="../_static/logo_small.png" as="image" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Extras - FileFormats v0.15.6</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=beddf052" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: #0e691b;
  --color-brand-content: #0e691b;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #111111;
  --color-code-foreground: #ffffff;
  --color-brand-primary: #5db754;
  --color-brand-content: #5db754;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #111111;
  --color-code-foreground: #ffffff;
  --color-brand-primary: #5db754;
  --color-brand-content: #5db754;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">FileFormats v0.15.6</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo_small.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">FileFormats v0.15.6</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detection.html">Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_handling.html">File handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mime.html">MIME types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../read_write.html">Read, write and convert</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typing.html">Typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Available Types</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/audio.html">Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/image.html">Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/video.html">Video</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/datascience.html">Datascience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/medimage.html">Medimage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Extensions</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Extras</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/developer/extras.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="extras">
<h1>Extras<a class="headerlink" href="#extras" title="Link to this heading">¶</a></h1>
<p>The functionality in addition to the core validation and detection typically requires
external dependencies and should be put into the separate <cite>extras</cite> project within the
apa Please use an &quot;extra&quot; hook and implement the method in an &quot;extras&quot; package in the
<a class="reference external" href="https://github.com/ArcanaFramework/fileformats-extension-template">extension template</a>,
to be called fileformats-&lt;yournamespace&gt;-extras.</p>
<section id="hooks-and-implementations">
<h2>Hooks and implementations<a class="headerlink" href="#hooks-and-implementations" title="Link to this heading">¶</a></h2>
<p>FileFormats <em>Extras</em> enable the creation of hooks in <cite>FileSet</cite> classes using the <cite>&#64;extra</cite>
decorator that can be implemented in separate modules using the <cite>&#64;extra_implementation</cite>
decorator. The &quot;extra methods&quot; typically add additional functionality for accessing and
maninpulating the data within the fileset, i.e. not required for format detection and
validation, and should be implemented in a separate package if they have external
dependencies to keep the main and extension packages dependency free. The
standard place to put these extras-implementations is in the sister &quot;extras&quot; package
named <cite>fileformats-&lt;yournamespace&gt;-extras</cite>, located in the <cite>extras</cite> directory in the
extension package root (see <a class="reference external" href="https://github.com/ArcanaFramework/fileformats-extension-template">https://github.com/ArcanaFramework/fileformats-extension-template</a>
for further instructions). It is possible to implement extra methods in other modules,
however, the extras package associated with formats namespace will be loaded by default
when a hooked method is accessed.</p>
<blockquote>
<div><p>Use the <cite>&#64;extra</cite> decorator on a method in the to define an extras method,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Self</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyFormat</span><span class="p">(</span><span class="n">File</span><span class="p">):</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.my&quot;</span>

    <span class="nd">@extra</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">my_extra_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p>and then reference that method in the extras package using the <cite>&#64;extra_implementation</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">some_external_package</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_my_format</span><span class="p">,</span> <span class="n">save_my_format</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fileformats.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">extra_implementation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fileformats.mypackage</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyFormat</span>

<span class="nd">@extra_implementation</span><span class="p">(</span><span class="n">MyFormat</span><span class="o">.</span><span class="n">my_extra_method</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_extra_method</span><span class="p">(</span>
    <span class="n">my_format</span><span class="p">:</span> <span class="n">MyFormat</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyFormat</span><span class="p">:</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">load_my_format</span><span class="p">(</span><span class="n">my_format</span><span class="o">.</span><span class="n">fspath</span><span class="p">)</span>
    <span class="n">data_array</span><span class="p">[:</span><span class="n">index</span><span class="p">]</span> <span class="o">*=</span> <span class="n">scale</span>
    <span class="n">save_my_format</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">data_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MyFormat</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
</pre></div>
</div>
<p>The first argument to the implementation functions is the instance the method
is executed on, and the types of the remaining arguments and return need to match
the hooked method exactly.</p>
<p>It is possible to provide multiple overloads for subclasses of the format that defines
the hook. Like <cite>functools.singledispacth</cite> (which is used under the hood), the type of
the first argument (not the type of the class the method is referenced from in the decorated)
determines which of the overloaded methods is called</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyFormatX</span><span class="p">(</span><span class="n">MyFormat</span><span class="p">):</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.myx&quot;</span>

<span class="nd">@extra_implementation</span><span class="p">(</span><span class="n">MyFormat</span><span class="o">.</span><span class="n">my_extra_method</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_extra_method</span><span class="p">(</span>
    <span class="n">my_format</span><span class="p">:</span> <span class="n">MyFormat</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyFormat</span><span class="p">:</span>
    <span class="o">...</span>

<span class="nd">@extra_implementation</span><span class="p">(</span><span class="n">MyFormat</span><span class="o">.</span><span class="n">my_extra_method</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_extra_method</span><span class="p">(</span>
    <span class="n">my_format</span><span class="p">:</span> <span class="n">MyFormatX</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyFormatX</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="registering-converters">
<h2>Registering converters<a class="headerlink" href="#registering-converters" title="Link to this heading">¶</a></h2>
<p>Converters between two equivalent formats are defined using <a class="reference external" href="https://pydra.readthedocs.io">Pydra</a> dataflow engine
<a class="reference external" href="https://pydra.readthedocs.io/en/latest/components.html">tasks</a>. There are two types
of <a class="reference external" href="https://pydra.readthedocs.io">Pydra</a> tasks, function tasks, Python functions decorated by <code class="docutils literal notranslate"><span class="pre">&#64;pydra.mark.task</span></code>, and
shell-command tasks, which wrap command-line tools in Python classes. To register a
<a class="reference external" href="https://pydra.readthedocs.io">Pydra</a> task as a converter between two file formats it needs to be decorated with the
<code class="docutils literal notranslate"><span class="pre">&#64;fileformats.core.converter</span></code> decorator. Like the implementation of extra methods,
converters should be implemented in the sister extras package.</p>
<p>Pydra uses type annotations to define the input and outputs of the tasks. It there is
a input to the task named <code class="docutils literal notranslate"><span class="pre">in_file</span></code>, and either a single anonymous output or an output
named <code class="docutils literal notranslate"><span class="pre">out_file</span></code>, and both are format classes, then no arguments need to be passed
to the converter decorator and the conversion source and target formats are determined
automatically. For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pydra.mark</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fileformats.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">converter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.mypackage</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyFormat</span><span class="p">,</span> <span class="n">MyOtherFormat</span>


<span class="nd">@converter</span>
<span class="nd">@pydra</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_my_format</span><span class="p">(</span><span class="n">in_file</span><span class="p">:</span> <span class="n">MyFormat</span><span class="p">,</span> <span class="n">conversion_argument</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyOtherFormat</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;out&quot;</span> <span class="o">+</span> <span class="n">MyOtherFormat</span><span class="o">.</span><span class="n">ext</span><span class="p">)</span>
    <span class="o">...</span> <span class="n">do</span> <span class="n">conversion</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">MyOtherFormat</span><span class="o">.</span><span class="n">save_new</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>defines a converter between <code class="docutils literal notranslate"><span class="pre">MyFormat</span></code> and <code class="docutils literal notranslate"><span class="pre">MyOtherFormat</span></code>, with the converter
argument <code class="docutils literal notranslate"><span class="pre">conversion_argument</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;converter</span></code> decorator registers the class in a class attribute of the target class,
therefore only if module containing the converter methods is imported will the converters
be available. Converter arguments can be passed as keyword-arguments to the
<code class="docutils literal notranslate"><span class="pre">get_converter</span></code> and <code class="docutils literal notranslate"><span class="pre">convert</span></code> methods if required.</p>
<p>Sometimes the source and target formats cannot be automatically determined from the
task signature, and need to be provided as arguments to the <code class="docutils literal notranslate"><span class="pre">&#64;converter</span></code> decorator
instead. For example, the converter between raster images using the <code class="docutils literal notranslate"><span class="pre">imageio</span></code> package
to do a generic conversion between all image types,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pydra.mark</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pydra.engine.specs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fileformats.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">converter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.raster</span><span class="w"> </span><span class="kn">import</span> <span class="n">RasterImage</span><span class="p">,</span> <span class="n">Bitmap</span><span class="p">,</span> <span class="n">Gif</span><span class="p">,</span> <span class="n">Jpeg</span><span class="p">,</span> <span class="n">Png</span><span class="p">,</span> <span class="n">Tiff</span>


<span class="nd">@converter</span><span class="p">(</span><span class="n">target_format</span><span class="o">=</span><span class="n">Bitmap</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">Bitmap</span><span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span><span class="n">target_format</span><span class="o">=</span><span class="n">Gif</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">Gif</span><span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span><span class="n">target_format</span><span class="o">=</span><span class="n">Jpeg</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">Jpeg</span><span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span><span class="n">target_format</span><span class="o">=</span><span class="n">Png</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">Png</span><span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span><span class="n">target_format</span><span class="o">=</span><span class="n">Tiff</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">Tiff</span><span class="p">)</span>
<span class="nd">@pydra</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">task</span>
<span class="nd">@pydra</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">annotate</span><span class="p">({</span><span class="s2">&quot;return&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;out_file&quot;</span><span class="p">:</span> <span class="n">RasterImage</span><span class="p">}})</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_image</span><span class="p">(</span><span class="n">in_file</span><span class="p">:</span> <span class="n">RasterImage</span><span class="p">,</span> <span class="n">output_format</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">:</span> <span class="n">ty</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">out_dir</span> <span class="o">/</span> <span class="p">(</span><span class="n">in_file</span><span class="o">.</span><span class="n">fspath</span><span class="o">.</span><span class="n">stem</span> <span class="o">+</span> <span class="n">output_format</span><span class="o">.</span><span class="n">ext</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_format</span><span class="o">.</span><span class="n">save_new</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">data_array</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case because we can write the converter in a generic way that allows us to convert
between any image type supported by <code class="docutils literal notranslate"><span class="pre">imageio</span></code>, we use the <code class="docutils literal notranslate"><span class="pre">RasterImage</span></code> base class
for the input and output format, and explicitly set the <code class="docutils literal notranslate"><span class="pre">target_format</span></code> of the output
for each of the support output formats. We also pass <code class="docutils literal notranslate"><span class="pre">output_format</span></code> as a keyword argument
from the converter decorator to specify the format we want to convert to.</p>
<p>Note that while the <code class="docutils literal notranslate"><span class="pre">source_format</span></code> can be a base class of the format to be converted,
the <code class="docutils literal notranslate"><span class="pre">target_format</span></code> can't be, since the subclass my have specific characteristics not
captured by transformation to the base class. However, you can attempt to &quot;cast&quot; a
base class to a sub-class simply by providing the base class as an input, since it will
simply iterate over paths in the base class and attempt to validate them.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_format</span> <span class="o">=</span> <span class="n">SubFormat</span><span class="p">(</span><span class="n">BaseFormat</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">another_format</span><span class="p">))</span>
</pre></div>
</div>
<p>Shell commands are marked as converters in the same way as function tasks, and existing
ShellCommandTask classes can be registered by calling the converter method on the ShellCommandTask
directly. If required, you can also map the input and output files to <code class="docutils literal notranslate"><span class="pre">in_file</span></code> and
<code class="docutils literal notranslate"><span class="pre">out_file</span></code> via the converter decorator for any converter task and set appropriate
input fields</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fileformats.yourpackage</span><span class="w"> </span><span class="kn">import</span> <span class="n">YourFormat</span><span class="p">,</span> <span class="n">YourOtherFormat</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydra.tasks.thirdparty</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThirdPartyShellCmd</span>

<span class="n">converter</span><span class="p">(</span>
    <span class="n">source_format</span><span class="o">=</span><span class="n">YourFormat</span><span class="p">,</span>
    <span class="n">target_format</span><span class="o">=</span><span class="n">YourOtherFormat</span><span class="p">,</span>
    <span class="n">in_file</span><span class="o">=</span><span class="n">your_file</span><span class="p">,</span>
    <span class="n">out_file</span><span class="o">=</span><span class="n">other_file</span><span class="p">,</span>
    <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
<span class="p">)(</span><span class="n">ThirdPartyShellCmd</span><span class="p">)</span>
</pre></div>
</div>
<p>If you need to map any of the converter arguments or perform more complex logic, it is
also possible to decorate a generic function that returns an instantiated <a class="reference external" href="https://pydra.readthedocs.io">Pydra</a> task,
such as in the <code class="docutils literal notranslate"><span class="pre">mrconvert</span></code> converter in the <code class="docutils literal notranslate"><span class="pre">fileformats-medimage</span></code> package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@converter</span><span class="p">(</span><span class="n">source_format</span><span class="o">=</span><span class="n">MedicalImage</span><span class="p">,</span> <span class="n">target_format</span><span class="o">=</span><span class="n">Analyze</span><span class="p">,</span> <span class="n">out_ext</span><span class="o">=</span><span class="n">Analyze</span><span class="o">.</span><span class="n">ext</span><span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span>
    <span class="n">source_format</span><span class="o">=</span><span class="n">MedicalImage</span><span class="p">,</span> <span class="n">target_format</span><span class="o">=</span><span class="n">MrtrixImage</span><span class="p">,</span> <span class="n">out_ext</span><span class="o">=</span><span class="n">MrtrixImage</span><span class="o">.</span><span class="n">ext</span>
<span class="p">)</span>
<span class="nd">@converter</span><span class="p">(</span>
    <span class="n">source_format</span><span class="o">=</span><span class="n">MedicalImage</span><span class="p">,</span>
    <span class="n">target_format</span><span class="o">=</span><span class="n">MrtrixImageHeader</span><span class="p">,</span>
    <span class="n">out_ext</span><span class="o">=</span><span class="n">MrtrixImageHeader</span><span class="o">.</span><span class="n">ext</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mrconvert</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">out_ext</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initiate an MRConvert task with the output file extension set</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        name of the converter task</span>
<span class="sd">    out_ext : str</span>
<span class="sd">        extension of the output file, used by MRConvert to determine the desired format</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pydra.ShellCommandTask</span>
<span class="sd">        the converter task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pydra_mrtrix3_utils</span><span class="o">.</span><span class="n">MRConvert</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s2">&quot;out&quot;</span> <span class="o">+</span> <span class="n">out_ext</span><span class="p">)</span>
</pre></div>
</div>
<p>Since converter tasks rely on <a class="reference external" href="https://pydra.readthedocs.io">Pydra</a>, which should be added as an &quot;extended&quot; dependency,
they are not loaded by default. However, if there is a package at
<code class="docutils literal notranslate"><span class="pre">fileformats.&lt;namespace&gt;.converters</span></code>, it will be attempted to be imported and throw
a warning if the import fails, when get_converter is called on a format in that
namespace.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the converters aren't imported successfully, then you will receive a
<code class="docutils literal notranslate"><span class="pre">FormatConversionError</span></code> error saying there are no converters between FormatA and
FormatB.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="extensions.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Extensions</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Thomas G. Close
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Extras</a><ul>
<li><a class="reference internal" href="#hooks-and-implementations">Hooks and implementations</a></li>
<li><a class="reference internal" href="#registering-converters">Registering converters</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=f6cf9268"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>